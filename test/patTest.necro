-- -- Layout version
-- -- More elegant but doesn't easily allow for things like polyrhythms
-- fpat :: Event Audio
-- fpat = speed m <| s * m where
--     s = pat 0   1 _ 2 mouseX fpat _ (delay 0 s)
--     m = pat 0.5 1 2

latch :: a -> Event a -> a
latch x _ = x

poly :: Num a => (a -> a) -> Event a -> a
poly _ _ = 0

now :: Num a => Event a -> a
now _ = 0

id :: a -> a
id x = x

speed :: Rational -> a -> a
speed _ x = x

-- TODO: Pattern list
patTest :: Event Audio
patTest = speed 2 <| pat
    0.5 z _ x
    _   3 y z
    where
        x = 0.5 * 2
        y = latch 0 <| pat 0 _ 1 _
        z = 666 * 323

coolSynth :: Audio
coolSynth = poly id patTest
